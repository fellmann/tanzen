"use strict";(self.webpackChunkggc_distance=self.webpackChunkggc_distance||[]).push([[691],{3330:function(e,t){t.Z=function(e){return setTimeout((function(){return e.target.setSelectionRange(0,10)}),1)}},8042:function(e,t,r){function n(e){return Array.from({length:e},(function(){return 0}))}function a(e){return Array.from({length:e},(function(e,t){return t}))}function l(e,t){return Array.from({length:e},(function(){return n(t)}))}r.d(t,{et:function(){return n},Ue:function(){return a},_X:function(){return l}})},3380:function(e,t,r){r.r(t),r.d(t,{default:function(){return _}});var n=r(7294),a=r(4294),l=r(2982),o=r(2346),u=r(3075),i=r(8054),c=r(3330),s=r(8042);function m(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function v(e){return e?(e.from+e.to)/2:0}function d(e,t,r){for(var n=Math.floor(e.judges/2)+1,a=[],l=0;l<e.competitors;l++){for(var o=(0,s.et)(e.competitors+1),u=(0,s.et)(e.competitors+1),i=0;i<e.judges;i++){var c,f,v=null!==(c=null===(f=e.marks[l])||void 0===f?void 0:f[i])&&void 0!==c?c:0;if(v>0)for(var d=v;d<=e.competitors;d++)o[d]++,u[d]+=v}a[l]={majority:o,sum:u,index:l}}for(var p=t||(0,s.Ue)(e.competitors),h=(0,s.Ue)(e.competitors).map((function(t){return(0,s.et)(e.competitors+1).map((function(e){}))})),k=[],E=r||1,b=E;p.length&&b<=e.competitors;){for(var y,j=g(p.map((function(e){return a[e]})).map((function(e){var t=null==e?void 0:e.majority[b],r=h[(null==e?void 0:e.index)||0];return r&&(r[b]=0==t?"-":null==t?void 0:t.toString()),e})).filter((function(e){return((null==e?void 0:e.majority[b])||0)>=n})).map((function(e){return{index:e.index,majority:e.majority.slice(b),sum:e.sum.slice(b)}})),(function(e,t){for(var r=0;r<e.majority.length;r++){var n=b+r;h[e.index][n]=e.majority[r].toString(),h[t.index][n]=t.majority[r].toString();var a=(t.majority[r]||0)-(e.majority[r]||0);if(a)return a;h[e.index][n]+=" ("+e.sum[r]+")",h[t.index][n]+=" ("+t.sum[r]+")";var l=(e.sum[r]||0)-(t.sum[r]||0);if(l)return l}return 0})),S=m(j);!(y=S()).done;){for(var w,I=y.value,N=function(){var e=w.value;k[e.index]={from:E,to:E+I.length-1},p=p.filter((function(t){return t!=e.index}))},A=m(I);!(w=A()).done;)N();E+=I.length}b++}return{places:k,table:h}}function p(e){return{from:e,to:e}}function g(e,t){if(0==e.length)return[];if(1==e.length)return[e];for(var r=e.sort(t),n=[],a=0,l=0;l<r.length;l=a){for(a=l+1;a<r.length&&0==t(r[l],r[a]);)a++;n.push(r.slice(l,a))}return n}function h(e,t,r){for(var n,a=(0,s._X)(t,r),l=0,o=m(e);!(n=o()).done;){for(var u=n.value,i=0;i<t;i++)for(var c=0;c<u.judges;c++)a[i][c+l]=u.marks[i][c];l+=u.judges}return a}function k(e){if("object"!=typeof e)return e;var t,r,n=Object.prototype.toString.call(e);if("[object Object]"===n){if(e.constructor!==Object&&"function"==typeof e.constructor)for(t in r=new e.constructor,e)e.hasOwnProperty(t)&&r[t]!==e[t]&&(r[t]=k(e[t]));else for(t in r={},e)"__proto__"===t?Object.defineProperty(r,t,{value:k(e[t]),configurable:!0,enumerable:!0,writable:!0}):r[t]=k(e[t]);return r}if("[object Array]"===n){for(t=e.length,r=Array(t);t--;)r[t]=k(e[t]);return r}return"[object Set]"===n?(r=new Set,e.forEach((function(e){r.add(k(e))})),r):"[object Map]"===n?(r=new Map,e.forEach((function(e,t){r.set(k(t),k(e))})),r):"[object Date]"===n?new Date(+e):"[object RegExp]"===n?((r=new RegExp(e.source,e.flags)).lastIndex=e.lastIndex,r):"[object DataView]"===n?new e.constructor(k(e.buffer)):"[object ArrayBuffer]"===n?e.slice(0):"Array]"===n.slice(-6)?new e.constructor(e):e}function E(e){for(var t,r=k(e),n=0,a=[],o=(0,s.et)(r.competitors+1),u=0;u<r.competitors;u++){a[u]=!0;for(var i=0;i<r.judges;i++){var c,m=(null===(c=r.marks[u])||void 0===c?void 0:c[i])||0;if(m<=0||m>r.competitors){a[u]=!1;break}}if(a[u]){for(var f=0;f<r.judges;f++){var g,h=(null===(g=r.marks[u])||void 0===g?void 0:g[f])||0;o[h]++}n++}}function E(e){var t=a.map((function(e,t){return e?-1:t})).filter((function(e){return e>=0}));if(0!=t.length){for(var n=t.filter((function(t,r){return r<e})),u=t.filter((function(t,r){return r>=e})),i=[],c=function(e){i.push.apply(i,(0,l.Z)((0,s.et)(r.judges-(o[e]||0)).map((function(){return e}))))},m=r.competitors;m>0;m--)c(m);for(var f=function(){for(var e=d[v],t=(0,s.et)(r.competitors),n=(0,l.Z)(e),a=0;a<r.judges;a++){for(var o=0;o<n.length;o++){var u=r.marks[n[o]||0],c=i.pop()||0;u&&(u[a]=c),t[n[o]||0]+=c}n=n.sort((function(e,r){return-(t[e]||0)+(t[r]||0)}))}},v=0,d=[n,u];v<d.length;v++)f()}}for(var b=[],y={from:p(r.competitors),to:p(1)},j=0;j<r.competitors;j++)a[j]?b[j]={from:p(r.competitors),to:p(1)}:b[j]=y;for(var S=0;S<=r.competitors-n;S++){E(S);var w=d(r);t=w.table;for(var I=0;I<r.competitors;I++){var N=w.places[I];if(N){var A=b[I];A&&(v(A.from)>v(N)&&(A.from=N),v(A.to)<v(N)&&(A.to=N))}}}if(t&&n<r.competitors-1)for(var x=0;x<r.competitors;x++)a[x]||(t[x]=(0,s.et)(r.competitors+1).map((function(e){return""})));return{table:t,places:b}}function b(e){for(var t=Object.assign({},e,{marks:(0,s._X)(e.competitors,e.judges)}),r=0;r<e.competitors;r++)for(var n=0;n<e.judges;n++){var a;t.marks[r][n]=(null===(a=e.marks[r])||void 0===a?void 0:a[n])||0}return t}var y=(0,o.LO)({competitors:6,judges:5,marks:[b({competitors:6,judges:5,marks:[]})],results:void 0,setMark:function(e,t,r,n){var a,l=null===(a=this.marks[e])||void 0===a?void 0:a.marks[t];l&&(l[r]=n)},setCompetitors:function(e){this.competitors=e;for(var t=0;t<this.marks.length;t++)this.marks[t]=b(Object.assign({},this.marks[t],{competitors:Math.min(9,e)}))},setJudges:function(e){this.judges=e;for(var t=0;t<this.marks.length;t++)this.marks[t]=b(Object.assign({},this.marks[t],{judges:Math.min(11,e)}))},setDances:function(e){for(var t=[],r=0;r<e;r++)t[r]=this.marks[r]||b({marks:[],judges:this.judges,competitors:this.competitors});this.marks=t},delete:function(){if(confirm("Alle Wertungen löschen?"))for(var e=0;e<this.marks.length;e++)this.marks[e]=b(Object.assign({},this.marks[e],{marks:[]}))},get valid(){for(var e=this.marks.map((function(e){return e.marks.map((function(e){return e.map((function(){return!0}))}))})),t=this.marks.map((function(){return!0})),r=0;r<this.marks.length;r++){var n=this.marks[r];if(n)for(var a=0;a<n.judges;a++)for(var l=[],o=0;o<n.competitors;o++){var u,i,c=(null===(u=n.marks[o])||void 0===u?void 0:u[a])||0;c<=0?t[r]=!1:c>n.competitors?(e[r][o][a]=!1,t[r]=!1):(null!==(i=l[c])&&void 0!==i?i:-1)>=0&&(e[r][o][a]=!1,e[r][l[c]][a]=!1,t[r]=!1),l[c]=o}}return{danceValid:t,valid:e}}}),j="undefined"!=typeof window&&window.localStorage.getItem("final");if(j){var S=JSON.parse(j);Object.assign(y,S)}(0,o.EH)((function(){var e=JSON.stringify({marks:y.marks,judges:y.judges,competitors:y.competitors});localStorage.setItem("final",e)}),{delay:500}),(0,o.EH)((function(){Date.now();var e=y.marks.map((function(e){return E(e)})),t=y.valid.danceValid.map((function(t,r){var n,a;return t?{marks:y.marks[r],places:null===(n=e[r])||void 0===n||null===(a=n.places)||void 0===a?void 0:a.map((function(e){return e.from}))}:null})).filter((function(e){return!!e})).map((function(e){return e})),r=t.length>1?function(e){var t;if(!(e.length<2)){var r=(null===(t=e[0])||void 0===t?void 0:t.marks.competitors)||0;if(r){for(var n=(0,s.et)(r).map((function(e){return p(e+1)})),a=(0,s.et)(r),l=(0,s._X)(r,r+1),o=(0,s._X)(r,r+1),u=e.map((function(e){return e.marks.judges})).reduce((function(e,t){return e+t})),i={competitors:r,judges:u,marks:h(e.map((function(e){return e.marks})),r,u)},c=[],f=[],k=(0,s._X)(r,e.length+1).map((function(e){return e.map((function(){return""}))})),E=0;E<e.length;E++)for(var b=e[E],y=0;y<r;y++){var j=v(b.places[y]);k[y][E]=j.toString(),a[y]+=j;for(var S=r;S>=j;S--)l[y][S]++,o[y][S]+=j}for(var w=0;w<r;w++)k[w][e.length]=a[w].toString();for(var I,N=g((0,s.Ue)(r),(function(e,t){return a[e]-a[t]})),A=1,x=m(N);!(I=x()).done;){var O=I.value;if(1==O.length){var M=O[0];n[M]=p(A),k[M][e.length+1]=v(n[M]).toString(),A++}else{for(var D,C=O,Z=(0,s.et)(r).map((function(){return e.length+1})),P=m(C);!(D=P()).done;){var U=D.value;k[U][e.length+1]="punktgleich für "+A+"."}for(;C.length>0;){var _=g(C,(function(e,t){return l[t][A]-l[e][A]}))[0],z=g(_,(function(e,t){return o[e][A]-o[t][A]}))[0];1==z.length?function(){var e=z[0];n[e]=p(A),k[e][Z[e]+1]=v(n[e]).toString(),C=C.filter((function(t){return t!=e})),A++}():function(){for(var e,t=m(z);!(e=t()).done;){var r=e.value;k[r][Z[r]+1]="punktgleich für "+A+"."}for(var a=d(i,z,A),l=0;l<a.table.length;l++)for(var o=0;o<a.table[l].length;o++){var u,s=a.table[l][o],p=(null===(u=c[l])||void 0===u?void 0:u[o])||"";a.table[l][o]=s>p?s:p}c=a.table;for(var h=g(z,(function(e,t){return v(a.places[e])-v(a.places[t])})),E=0;E<h.length;E++){var b=h[E];if(E>0&&(h.length>2||b.length>1))for(var y,j=m(b);!(y=j()).done;){var S=y.value;Z[S]+=2}else{for(var w,I=function(){var e=w.value;n[e]={from:A,to:A+b.length-1},f[e]=a.places[e],k[e][Z[e]+2]=v(n[e]).toString(),C=C.filter((function(t){return t!=e}))},N=m(b);!(w=N()).done;)I();A+=b.length}}}()}}}return{places:n,table:k,skatingTable:c,skatingPlaces:f}}}}(t):void 0,n={results:e,skating:r,dances:t.length};(0,o.z)((function(){return y.results=n}))}),{delay:200});var w=y,I=w,N=(0,u.Pi)((function(){return(0,n.useEffect)((function(){document.title="Finalrechner Majoritäts- & Skatingsystem"}),[]),n.createElement(i.W2,null,n.createElement("h1",null,"Finalrechner Majoritäts- & Skatingsystem"),n.createElement("p",null,"Die Wertungen werden automatisch gespeichert."),n.createElement(P,null),n.createElement("br",null),n.createElement(i.zx,{onClick:function(){return I.delete()}},"Wertungen zurücksetzen"),I.marks.map((function(e,t){return n.createElement(x,{dance:t,key:t})})),n.createElement(A,null))})),A=(0,u.Pi)((function(){var e;return null!==(e=I.results)&&void 0!==e&&e.skating?n.createElement("div",{className:"dance-section"},n.createElement("h3",null,"Gesamtergebnis"),n.createElement(U,null),n.createElement("h5",{className:"mt-2 mb-0"},"Ergebnistabelle"),n.createElement(Z,{table:(0,o.ZN)(I.results.skating.table),places:I.results.skating.places}),!!I.results.skating.skatingTable.length&&n.createElement(n.Fragment,null,n.createElement("h5",{className:"mt-2 mb-0"},"Skatingtabelle"),n.createElement(C,{table:I.results.skating.skatingTable,places:I.results.skating.skatingPlaces}))):null})),x=(0,u.Pi)((function(e){var t,r=e.dance,a=null===(t=I.results)||void 0===t?void 0:t.results[r],l=(0,n.useState)((function(){return!1})),o=l[0],u=l[1];return n.createElement("div",{key:r,className:"dance-section"},I.marks.length>1&&n.createElement("h3",null,r+1,". Tanz"),n.createElement(O,{dance:r,places:null==a?void 0:a.places}),n.createElement("br",null),!(null==a||!a.table)&&n.createElement(n.Fragment,null,n.createElement(i.zx,{size:"sm",onClick:function(){return u(!o)}},"Wertungstabelle"),n.createElement(i.UO,{isOpen:o},n.createElement(C,{table:a.table,places:a.places}))))})),O=(0,u.Pi)((function(e){var t=I.marks[e.dance];if(!t)return null;var r=e.dance*t.competitors*t.judges,a=function(e){var t=document.getElementById("im"+e);null==t||t.focus(),null==t||t.select()};return n.createElement("div",{className:"mark-input"},n.createElement("table",{className:"mark-input"},n.createElement("tbody",null,t.marks.map((function(l,o){return n.createElement("tr",{className:"mark-row",key:o},n.createElement("td",{className:"mark-label"},"#",o+1),l.map((function(u,s){var m,f,v=r++;return n.createElement("td",{className:"mark-input",key:s},n.createElement(i.II,{draggable:"false",onDragStart:function(e){return e.preventDefault()},style:{backgroundColor:!1===(null===(m=I.valid.valid[e.dance])||void 0===m||null===(f=m[o])||void 0===f?void 0:f[s])?"#fcc":void 0},onContextMenu:function(e){return e.preventDefault()},autoComplete:"off",id:"im"+v,inputMode:"numeric",pattern:"[0-9]*",key:s,value:u||"",onFocus:c.Z,onKeyDown:function(e){l[s]||"Backspace"!=e.key?"ArrowUp"==e.key?(e.preventDefault(),a(v-I.judges)):"ArrowDown"==e.key?(e.preventDefault(),a(v+I.judges)):"ArrowRight"==e.key?(e.preventDefault(),a(v+1)):"ArrowLeft"==e.key&&(e.preventDefault(),a(v-1)):(e.preventDefault(),a(v-1))},onInput:function(r){var n,a=parseInt(r.currentTarget.value||"0");a>=0&&a<=t.competitors&&(I.setMark(e.dance,o,s,a),a>0&&(null===(n=document.getElementById("im"+(v+1)))||void 0===n||n.focus()))}}))})),n.createElement("td",{className:"mark-label"},!!e.places&&D(e.places[o])))})))))}));function M(e){return null!=e&&e.from&&null!=e&&e.to?v(e).toLocaleString():"-"}function D(e){if(null==e||!e.from||null==e||!e.to)return"-";var t=v(e.from),r=v(e.to);return t==r?t.toLocaleString():t.toLocaleString()+"-"+r.toLocaleString()}var C=(0,u.Pi)((function(e){var t,r=e.table,a=e.places;return n.createElement(i.iA,{bordered:!0,responsive:!0,size:"sm",className:"result-table"},n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",null,"Nr."),null===(t=r[0])||void 0===t?void 0:t.map((function(e,t){return t>0&&n.createElement("th",{key:t},t>1?"1-"+t:t)})),n.createElement("th",null,"Ergebnis"))),n.createElement("tbody",null,r.map((function(e,t){var r;return n.createElement("tr",{key:t},n.createElement("td",null,"#",t+1),e.map((function(e,t){return t>0&&n.createElement("td",{key:t},void 0===e?"—":e)})),n.createElement("td",null,a.length>t&&!!a[t]&&("number"==typeof(null===(r=a[t])||void 0===r?void 0:r.from)?M(a[t]):D(a[t]))))}))))})),Z=(0,u.Pi)((function(e){var t,r=e.table,a=e.places,o=Math.max.apply(Math,(0,l.Z)(r.map((function(e){return e.length})))),u=(null===(t=w.results)||void 0===t?void 0:t.dances)||0,c=o-u-2,m=(0,s.Ue)(o);return n.createElement(i.iA,{bordered:!0,responsive:!0,size:"sm",className:"result-table"},n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",null,"Nr."),(0,s.Ue)(u).map((function(e,t){return n.createElement("th",{key:t},t+1)})),n.createElement("th",null,"Summe"),n.createElement("th",null,"Regel 9"),(0,s.Ue)(c).map((function(e){return n.createElement("th",{key:e},"Regel ",10+e%2)})),n.createElement("th",null,"Ergebnis"))),n.createElement("tbody",null,r.map((function(e,t){return n.createElement("tr",{key:t},n.createElement("td",null,"#",t+1),m.map((function(a){var l=e[a],o=1;if(null!=l&&l.startsWith("punktgleich")){var u;if((null===(u=r[t-1])||void 0===u?void 0:u[a])==l)return null;for(;(null===(i=r[t+o])||void 0===i?void 0:i[a])==l;){var i;o++}}return n.createElement("td",{key:a,rowSpan:o},void 0===l?"—":l)})),n.createElement("td",null,M(a[t])))}))))})),P=(0,u.Pi)((function(){return n.createElement("div",{className:"final-inputs"},n.createElement("form",null,n.createElement(i.BZ,null,n.createElement(i.O3,null,"Teilnehmer"),n.createElement(i.II,{inputMode:"numeric",pattern:"[0-9]*",value:I.competitors,onFocus:c.Z,onChange:function(e){I.setCompetitors(parseInt(e.target.value||"0"))},style:{textAlign:"right"}})),n.createElement(i.BZ,null,n.createElement(i.O3,null,"Wertungsrichter"),n.createElement(i.II,{inputMode:"numeric",pattern:"[0-9]*",value:I.judges,onFocus:c.Z,onChange:function(e){I.setJudges(parseInt(e.target.value||"0"))},style:{textAlign:"right"}})),n.createElement(i.BZ,null,n.createElement(i.O3,null,"Tänze"),n.createElement(i.II,{inputMode:"numeric",pattern:"[0-9]*",value:I.marks.length,onFocus:c.Z,onChange:function(e){return I.setDances(parseInt(e.target.value||"0"))},style:{textAlign:"right"}}))))})),U=(0,u.Pi)((function(){var e,t,r,a=null===(e=I.results)||void 0===e||null===(t=e.skating)||void 0===t?void 0:t.places,l=null===(r=I.results)||void 0===r?void 0:r.results;return a&&l?n.createElement("div",{className:"mark-input"},n.createElement("table",{className:"mark-input"},n.createElement("tbody",null,(0,s.Ue)(I.competitors).map((function(e){return n.createElement("tr",{className:"mark-row",key:e},n.createElement("td",{className:"mark-label"},"#",e+1),(0,s.Ue)(I.marks.length).map((function(t){var r,a;return n.createElement("td",{className:"mark-input",key:t},n.createElement("form",null,n.createElement(i.II,{value:I.valid.danceValid[t]&&v(null===(r=l[t])||void 0===r||null===(a=r.places[e])||void 0===a?void 0:a.from)||"",disabled:!0})))})),n.createElement("td",{className:"mark-label"},M(a[e])))}))))):null}));function _(){return n.createElement(a.Z,{title:"Majoritäts- und Skatingrechner"},n.createElement(N,null))}}}]);
//# sourceMappingURL=component---src-pages-index-tsx-f828de3d13ca6424880e.js.map